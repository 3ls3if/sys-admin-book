---
icon: windows
---

# Malware Detection (Runtime Broker Issue)

## Notes on Malware Detection (Runtime Broker Issue)

**1. Context**

* The issue involves **Runtime Broker (RuntimeBroker.exe)** consuming high memory or causing performance problems in Windows.
* This can sometimes be a symptom of **malware infection** masquerading as the legitimate Runtime Broker process.

***

**2. Checking for Malware**

* **Path Verification:**\
  The legitimate Runtime Broker process should be located at:\
  `C:\Windows\System32\RuntimeBroker.exe`\
  → If found elsewhere, it may be **malicious or fake**.
* **Secure Task Manager / Antivirus:**
  * Use a **secure task manager** or antivirus tool to inspect the process.
  * Check for **unusual CPU or memory usage**, **unknown publisher**, or **irregular digital signatures**.
* **Run a Full System Scan:**
  * Use **Windows Defender** or a trusted third-party antivirus.
  * Consider running an **offline scan** to detect hidden or persistent malware.

***

**3. System File Checker (SFC)**

* Purpose: Detects and repairs **corrupted or altered system files**, including those modified by malware.
*   Command:

    ```bash
    sfc /scannow
    ```
* Run this command in **Command Prompt (Admin)**.
* If malware has altered system files, SFC can **restore original versions** from Windows cache.

***

**4. Registry Editor Precaution**

* Sometimes malware or misconfigurations affect registry keys related to system processes.
*   Example Fix Path:

    ```
    HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\TimeBroker
    ```

    * Change `Start` value from `3` (manual) to `4` (disabled) to stop Runtime Broker from running automatically.
* **⚠️ Warning:**\
  Editing the registry incorrectly can cause serious issues.\
  Always **back up the registry** before making changes:
  * Microsoft guide: _“How to back up and restore the registry in Windows.”_

***

**5. General Malware Detection Tips**

* Keep Windows and security software **updated**.
* Avoid downloading software from **untrusted websites**.
* Monitor system performance — sudden slowdowns can signal infection.
* Use **Windows Security → Protection history** to check recent detections.

***

#### **Summary**

If Runtime Broker behaves abnormally:

1. Verify the process path (`System32`).
2. Scan for malware using antivirus tools.
3. Run `sfc /scannow` to repair system files.
4. Carefully adjust registry settings if necessary.
5. Reboot and monitor for improvements.



***

## REFERENCES

* [https://learn.microsoft.com/en-us/answers/questions/4046969/c-windowssystem32runtimebroker-exe-has-initiated-t](https://learn.microsoft.com/en-us/answers/questions/4046969/c-windowssystem32runtimebroker-exe-has-initiated-t)
